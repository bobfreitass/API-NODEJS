SELECT   

    PDV.IdPedidoDeVenda,
    TRIM(PDV.CdChamada) AS CdChamada,
    PDV.CdPedidoDeCompraCliente,
    PDV.CdEmpresa,
    PDV.CdEmpresaEstoque,
    PDV.CdEmpresaFinanceiro,
    PDV.IdSetor,
    PDV.DtEmissao,
    PDV.DtEntrada,
    PDV.DtEntrega,
    PDV.StPedidoDeVenda,
    PDV.IdPessoaCliente,
    PDV.CdEnderecoPrincipal,
    PDV.CdEnderecoCobranca,
    PDV.CdEnderecoEntrega,
    PDV.IdOperacao,
    PDV.IdOperacaoOE,
    PDV.IdPreco,
    PDV.IdPrazo,
    PDV.TpFretePorConta,
    PDV.IdPessoaTransportador,
    PDV.DsViaTransporte,
    PDV.IdPessoaTransportadorRedesp,
    PDV.DsObservacaoPedido,
    PDV.DsObservacaoDocumento,
    PDV.IdUsuario,
    PDV.StFaturamentoParcial,
    PDV.StMontagem,
    PDV.TpDesconto,
    PDV.NmEntidadeOrigem,
    PDV.IdEntidadeOrigem,
    PDV.DtCancelamento,
    PDV.IdUsuarioCancelamento,
    PDV.DtReferenciaPagamento,
    PDV.IdPessoaFinanceiro,
    PDV.IdPessoaEntrega,
    PDV.AlAcrescimo,
    PDV.AlDesconto,
    PDV.IdSistema,
    PDV.TpPedidoDeVenda,
    PDV.DsVolumes,
    PDV.TpIndAtendimentoPresencial,
    PDV.StRetiradaEstabelecimento,
    PDV.IdPessoaRetirada,
    (SELECT CAST(SUM(PDVI.VlItem) AS DECIMAL(10,2)) FROM PEDIDODEVENDAITEM AS PDVI WHERE PDVI.IdPedidoDeVenda = PDV.IdPedidoDeVenda) AS VlPedidoDeVenda

FROM PedidoDeVenda AS PDV (NOLOCK)
WHERE PDV.DtEmissao BETWEEN GETDATE()-360 AND GETDATE()
AND PDV.IdPedidoDeVenda =  @IdPDV